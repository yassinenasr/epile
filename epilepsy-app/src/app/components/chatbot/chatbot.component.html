<!-- Chat Toggle Button -->
<button (click)="toggleChat()"
    class="fixed bottom-6 right-6 z-50 bg-primary text-white p-4 rounded-full shadow-2xl hover:bg-purple-800 transition-transform hover:scale-110 flex items-center justify-center w-16 h-16 animate-bounce-slow">
    <span class="material-icons text-3xl" *ngIf="!isOpen">chat</span>
    <span class="material-icons text-3xl" *ngIf="isOpen">close</span>
</button>

<!-- Chat Window -->
<div *ngIf="isOpen"
    class="fixed bottom-24 right-6 z-50 w-80 md:w-96 bg-white dark:bg-slate-900 rounded-2xl shadow-2xl overflow-hidden border border-slate-200 dark:border-slate-700 flex flex-col max-h-[600px] animate-slide-up">

    <!-- Header -->
    <div class="bg-primary p-4 flex items-center gap-3">
        <div class="w-10 h-10 bg-white/20 rounded-full flex items-center justify-center">
            <span class="material-icons text-white">smart_toy</span>
        </div>
        <div>
            <h3 class="font-bold text-white text-lg">Moseif Bot</h3>
            <p class="text-white/80 text-xs">Always here to help</p>
        </div>
    </div>

    <!-- Messages Area -->
    <div class="flex-1 overflow-y-auto p-4 space-y-4 bg-slate-50 dark:bg-slate-800/50 min-h-[300px]">
        <div *ngFor="let msg of messages" class="flex flex-col gap-2"
            [ngClass]="{'items-end': msg.isUser, 'items-start': !msg.isUser}">

            <!-- Message Bubble -->
            <div [ngClass]="{
                'bg-primary text-white rounded-br-none': msg.isUser,
                'bg-white dark:bg-slate-700 text-slate-800 dark:text-white rounded-bl-none shadow-sm border border-slate-100 dark:border-slate-600': !msg.isUser
            }" class="px-4 py-3 rounded-2xl max-w-[85%] text-sm leading-relaxed">
                {{ msg.text }}
            </div>

            <!-- Options (if any) -->
            <div *ngIf="msg.options" class="flex flex-wrap gap-2 mt-1"
                [ngClass]="{'justify-end': msg.isUser, 'justify-start': !msg.isUser}">
                <button *ngFor="let opt of msg.options" (click)="opt.action()"
                    class="bg-white dark:bg-slate-800 border border-primary text-primary px-3 py-1.5 rounded-full text-xs font-bold hover:bg-primary hover:text-white transition-colors shadow-sm">
                    {{ opt.label }}
                </button>
            </div>

        </div>
    </div>

    <!-- Input Area (Placeholder for now, mostly option based) -->
    <!-- <div class="p-4 bg-white dark:bg-slate-900 border-t border-slate-100 dark:border-slate-800">
        <input type="text" placeholder="Type a message..." class="w-full bg-slate-100 dark:bg-slate-800 rounded-full px-4 py-2 text-sm focus:ring-2 ring-primary outline-none">
    </div> -->
</div>